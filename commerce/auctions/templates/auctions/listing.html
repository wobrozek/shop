{% extends "auctions/layout.html" %}

{% block body%}
<main>
<div class="auction-listing">

    {% include 'auctions/components/listingItem.html' %}


    {% if close %}
        {% if winnerBid != None %}
            <div class="winner">üèÜAuction is closed and the winner is: {{winnerBid.author }}üèÜ </div>
        {% else %}
            <div class="winner notWinner" >‚ùåAuction is closed and nobody wins the auction‚ùå </div>
        {% endif %}
    {% endif %}


    <h3>History</h3>
    <div class="recycleView">
        <ul>
        {% if not historyBid %}
            <div class="py-2">Nobody bids this auction yetüí§</div>
        {% else %}
        {% for bid in historyBid %}            
                <li class="d-flex justify-content-between align-content-center recycleView-bid">
                    <div class="d-flex">
                        <button class="image-circleWraper" >
                            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTsA8Uk6Moi9UCJYLnmIG0e6fJN0kfPZ7ISdA&usqp=CAU=" alt="profile image">
                        </button>
                        {{ bid.author }}
                    </div>
                    <div>
                        {{ bid.price }} PLN 
                    </div>
                </li>
            {% endfor %}
        {% endif %}
        </ul>
    </div>



    <h3> Details </h3>
        <ul>
            <li>Listed by: {{ auction.author}}</li>
            <li>category: {{auction.category}}</li>
            <li>Auction was created: {{ auction.startDate| date:"d-m-Y H:i" }} </li>
            <li>Auction expire date: {{ auction.endDate| date:" d-m-Y H:i" }}</li>
        </ul>
</div>


<h3>Comments</h3>

{% if user.is_authenticated %}
    <form action="/listing/comments/{{ auction.id }}" method="post">
        {% csrf_token %}
        {{formComments}}
        <input type="submit" class="btn btn-primary">
    </form>
{% endif %}

<div class="recycleView">
    <ul>
    {% if not comments %}
        <div class="py-2">Nobody comment this auction yetüí§</div>
    {% else %}
    {% for comment in comments %}            
            <li class="d-flex justify-content-between align-content-center recycleView-bid">
                <div class="d-flex">
                    <button class="image-circleWraper" >
                        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTsA8Uk6Moi9UCJYLnmIG0e6fJN0kfPZ7ISdA&usqp=CAU=" alt="profile image">
                    </button>
                    <div class="d-flex flex-column">
                        <div>{{ comment.author }}</div>
                        <div>{{ comment.text }}</div>
                    </div>
                </div>
            </li>
        {% endfor %}
    {% endif %}
    </ul>
</div>
</main>
{% endblock%}